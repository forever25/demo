<!doctype html>
<html>
<body>
	<canvas id="can" width="400" height="400" style="background: Black"></canvas>
	<script>


    var sn = [ 1, 0 ], dz = 2, fx = 1, n, ctx = document.getElementById("can").getContext("2d");

    document.onkeydown = function(e) {
      // fx = -1 ==

      console.log(e.keyCode);
			fx = (sn[1] - sn[0] == (n = [ -1, -20, 1, 20 ][(e || event).keyCode - 37] || fx)) ? fx : n   //
		};

		!function() {
      sn.unshift(n = sn[0] + fx);
      console.log(n);
			if (sn.indexOf(n, 1) > 0 || n<0 || n>399 || fx == 1 && n % 20 == 0 || fx == -1 && n % 20 == 19)
				return alert("GAME OVER");
			draw(n, "Lime");
			if (n == dz) {
				while (sn.indexOf(dz = ~~(Math.random() * 400)) >= 0);   // 重复添加food
				draw(dz, "Yellow");
			} else{
        draw(sn.pop(), "Black");   // 取出sn 最后一个数字
      }

			setTimeout(arguments.callee, 130);   /// 130 ms 回调此函数
    }();
// 定义与绑定

    function draw(t, c) {    //
			ctx.fillStyle = c; /// 添加方块的颜色
			ctx.fillRect(t % 20 * 20 + 1, ~~(t / 20) * 20 + 1, 18, 18);   // 绘制方块 参数为 x，y， w, h   ~~ 向下取整
		}
	</script>
</body>
</html>